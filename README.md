# 牛马 - Cursor 编辑器效率神器
<div align="center">
  <img src="./banner.jpg" alt="牛马" width="800">
</div>
为 <a href="https://cursor.sh/" target="_blank">Cursor</a> 编辑器打造的 Windows 效率神器！通过「CapsLock 牛马召唤器」快捷键方案，让 Cursor 做牛做马，替你扛下繁琐工作，编程效率狂飙 100%～

## ✨ 牛马核心特色
- 🚀 **CapsLock 召唤器**：短按保持大小写切换功能，长按 0.5s 调出牛马快捷面板，贴心不添乱
- ⚡ **零延迟响应**：所有操作即时反馈，使唤牛马不等待
- 🎨 **Cursor 同源风格**：深色主题无缝融合，牛马也懂颜值控
- 📋 **牛马记忆剪贴板**：连续复制、合并粘贴、历史管理，素材收集不费劲
- 🤖 **AI 牛马打工魂**：一键让 Cursor 解释、重构、优化代码，不用手动敲提示词
- ⚙️ **高度可调教**：自定义提示词、快捷键、面板位置，打造专属贴心牛马

## 🎯 牛马核心功能
### 1. 代码操作打工面板
- **长按 CapsLock** 召唤牛马快捷面板
- **CapsLock + E**：代码翻译官（牛马用新手能懂的话讲清核心逻辑、易错点）
- **CapsLock + R**：代码规整师（按规范重构、添加注释，牛马式整理）
- **CapsLock + O**：代码加速器（分析性能瓶颈，给出优化方案）
- **CapsLock + S**：代码分割工（插入分割标记，方便批量处理）
- **CapsLock + B**：批量打工模式（一次性处理多个代码块，牛马高效摸鱼...啊不，干活）

### 2. 连续复制 + 合并粘贴
- **CapsLock + C**：牛马记忆收集（连续复制多个片段，静默操作不打扰）
- **CapsLock + V**：牛马整理输出（自动用空格/换行符合并内容，粘贴到 Cursor）
- **CapsLock + X**：记忆管理面板（查看所有复制历史，按需取用）

### 3. 牛马记忆管理面板
- 📋 预览所有复制历史，一目了然
- 🔄 双击快速召回，不用重复复制
- ✂️ 删除无用记忆，减轻牛马负担
- 📤 直接粘贴选中内容到 Cursor，一步到位
- 🗑️ 一键清空记录，让牛马喝下孟婆汤

### 4. 调教牛马面板（CapsLock + Q）
- 📁 指定 Cursor 安装路径，让牛马找对主人
- ⏱️ 调整 AI 响应等待时间，适配不同配置电脑
- 💬 自定义PUA话术（修改解释/重构/优化提示词）
- ⌨️ 重设快捷键，避免冲突不闹心
- 🖥️ 多屏幕支持，自定义面板显示位置

## 📥 召唤牛马方式
### 方式一：直接召唤
1. 访问 [Releases](https://github.com/psterman/nmer/releases) 页面
2. 务必安装[autohotkey2.0](https://www.autohotkey.com/download/ahk-v2.exe)
3. 下载最新版本的 `牛马.ahk` 文件

### 方式二：安装exe懒人包版本


## 🔧 牛马上岗准备
### 基础要求
- **操作系统**：Windows 10/11（牛马只认 Windows 老家）
- **AutoHotkey**：v2.0 或更高版本（牛马的口粮，必须安排）
- **Cursor 编辑器**：已安装并能正常运行（余粮也不能缺席）

### 安装牛马口粮（AutoHotkey v2）
1. **下载口粮**：访问 [AutoHotkey 官网](https://www.autohotkey.com/)，[下载并安装 v2 版本](https://www.autohotkey.com/download/ahk-v2.exe)
2. **绑定口粮（可选）**：
   - 右键 `牛马.ahk` 文件 → 「打开方式」→ 选择 AutoHotkey
   - 勾选「始终使用此应用打开」，下次直接召唤

## 📦 调教牛马步骤
### 步骤 1：安置牛马
将 `牛马.ahk` 文件保存到固定目录（建议：`D:\Tools\牛马\`，方便找得到）

### 步骤 2：首次唤醒
1. 双击 `牛马.ahk` 文件
2. 提示获取管理员权限时，点击「是」（牛马需要权限才能监听指令）
3. 自动生成配置文件 `CursorShortcut.ini`，记录你的调教偏好

### 步骤 3：指定主人（Cursor 路径）
1. 右键系统托盘中的牛马图标
2. 选择「打开配置面板」或者尝试按 `CapsLock + Q`
3. 若 Cursor 不在默认路径，点击「浏览」选中 `Cursor.exe`
4. 点击「保存配置」，牛马从此认你为主

### 步骤 4：设置牛马随叫随到（开机自启，可选）
1. 按 `Win + R` 打开运行框，输入 `shell:startup` 回车打开启动文件夹
2. 长按ctrl+alt+左键，将 `牛马.ahk` 的快捷方式复制到启动文件夹
3. 或用任务计划程序设置，开机自动唤醒牛马

## 🚀 使唤牛马快速指南
### 1. 让牛马解释代码
- 在 Cursor 中选中目标代码
- 长按 `CapsLock` 召唤面板，按 `E` 键
- 牛马自动复制代码 + 填入提示词 + 发送给 Cursor，坐等结果

### 2. 让牛马收集素材
- 选中第一段文本 → 按 `CapsLock + C`
- 选中第二段文本 → 按 `CapsLock + C`
- 重复收集...
- 在cursor输入框按 `CapsLock + V` 合并粘贴到 Cursor，完美！

### 3. 管理牛马记忆
- 按 `CapsLock + X` 打开记忆面板
- 双击需要的内容快速复制
- 用底部按钮删除/清空，按需操作
- 查找复制记忆精准

### 牛马指令大全（快捷键）
| 快捷键 | 功能描述 |
|--------|----------|
| `长按 CapsLock` | 召唤牛马快捷面板 |
| `CapsLock + E` | 解释代码（牛马翻译官） |
| `CapsLock + R` | 重构代码（牛马规划师） |
| `CapsLock + O` | 优化代码（牛马加速器） |
| `CapsLock + S` | 分割代码（牛马分割工） |
| `CapsLock + B` | 批量操作（牛马流水线） |
| `CapsLock + C` | 连续复制（牛马记忆收集） |
| `CapsLock + V` | 合并粘贴（合并整理输出） |
| `CapsLock + X` | 打开记忆面板（牛马备忘录） |
| `CapsLock + Q` | 打开调教面板（牛马后台设置） |
| `ESC` | 关闭面板（让牛马待命） |

## ⚠️ 牛马罢工排查
### 常见问题
#### 1. 牛马唤醒失败（双击无反应）
- 检查是否安装 AutoHotkey v2（v1 版本不兼容，牛马不懂爱）
- 重新下载 `牛马.ahk` 文件，避免文件损坏
- 右键「以管理员身份运行」，给足权限

#### 2. 反复要求管理员权限
- 正常现象！牛马需要监听键盘指令，必须有权限
- 解决方案：右键 `牛马.ahk` →「属性」→「兼容性」→ 勾选「以管理员身份运行此程序」

#### 3. 召唤牛马后 Cursor 无反应
- 检查 Cursor 是否正在运行
- 确认配置面板中的 Cursor 路径正确（默认路径：`C:\Users\用户名\AppData\Local\Cursor\Cursor.exe`）
- 调整 AI 响应等待时间（建议 15000ms，避免牛马干活太快主人跟不上）

#### 4. 快捷键冲突（牛马不听指令）
- 打开调教面板（CapsLock + Q）修改快捷键
- 关闭冲突软件，给牛马专属指令通道

#### 5. 记忆面板打不开（CapsLock + X 无反应）
- 确认已用 `CapsLock + C` 复制过内容（牛马没记忆可展示）
- 检查系统托盘是否有牛马图标（脚本是否在运行）
- 重启脚本，让牛马重新加载

#### 6. 面板显示位置不对
- 打开调教面板 → 「面板位置设置」→ 选择正确屏幕
- 保存配置后重新召唤面板

### 深度调教（调试模式）
1. **查看错误信息**：牛马出错会弹出消息框，记录错误内容方便排查
2. **检查配置文件**：脚本目录下的 `CursorShortcut.ini`，可手动编辑（注意格式）
3. **重置牛马**：删除 `CursorShortcut.ini` 文件，重新运行脚本，恢复默认设置

## 🛠️ 高级调教技巧
### 自定义打工话术
在调教面板中修改 3 类提示词，让牛马按你的风格干活：
- 解释代码提示词：控制牛马的解释语气（比如更详细/更简洁）
- 重构代码提示词：指定代码规范（比如 PEP8/公司编码标准）
- 优化代码提示词：强调优化方向（比如速度优先/内存优先）

### 性能调教
- **AI 响应等待时间**：
  - 低配机：建议 20000ms（给牛马足够干活时间）
  - 高配机：建议 10000-15000ms（牛马干活快，不用等）
  - 默认：15000ms（平衡配置）

### 多屏幕调教
- 支持多屏幕环境，在调教面板选择目标屏幕
- 面板自动居中显示，不用担心找不到牛马

## 📝 牛马进化日志
### v1.0.0
- ✨ 初始版本发布，牛马正式上岗
- ✨ CapsLock 召唤器功能
- ✨ 代码解释/重构/优化打工技能
- ✨ 连续复制 + 合并粘贴记忆功能
- ✨ 记忆管理面板
- ✨ 调教面板（自定义设置）
- ✨ 多屏幕支持

## 🤝 调教牛马贡献
欢迎提交 Issue 和 Pull Request，一起优化牛马技能，让它更懂程序员的心！

## 📄 牛马版权声明
本项目采用 **Apache License 2.0** 开源许可证。

### 你可以：
- ✅ **自由使用**：个人、商业用途均可，无限制
- ✅ **修改代码**：根据需求自由定制、修改源码
- ✅ **分发传播**：可自由分享、分发原始或修改后的版本
- ✅ **商用授权**：允许将项目集成到商业产品中
- ✅ **专利授权**：获得贡献者的专利使用授权（需遵循许可证条款）

### 你需要遵守：
- ⚠️ **保留声明**：必须保留原始版权声明、许可证文本和作者声明
- ⚠️ **明确标注**：修改后的版本需明确标注修改内容和修改时间
- ⚠️ **免责声明**：不得移除许可证中的免责声明和责任限制条款

### 详细条款
请访问 [Apache License 2.0 官方页面](https://www.apache.org/licenses/LICENSE-2.0) 查看完整法律条款。
[![AutoHotkey v2](https://img.shields.io/badge/AutoHotkey-v2-blue.svg)](https://www.autohotkey.com/)

## 🙏 致谢
- [AutoHotkey](https://www.autohotkey.com/) - 牛马的生存基础，强大的 Windows 自动化工具
- [Cursor](https://cursor.sh/) - 牛马的主人，优秀的 AI 代码编辑器（被 millions 开发者信任，Stripe/OpenAI 都在用）
- [capslock+](https://github.com/wo52616111/capslock-plus/) - 灵感来源之一，wo52616111 capslock-plus作者
- [SQLiteDB] (https://www.autohotkey.com/boards/viewtopic.php?t=95389) -  感谢justme 的SQLite 数据库的功能，方便牛马记忆管理
- 所有调教牛马的新老贡献者和用户，我们会越来越强！

## 📮 联系牛马饲养员
- **Issues**：[GitHub Issues](https://github.com/psterman/nmer/issues)（反馈问题，让牛马改进）
- 扫微信码加好友，一起探讨御牛马术：

<img width="950" height="1296" alt="mmqrcode1765714128545" src="https://github.com/user-attachments/assets/68b79c9f-1311-4762-811a-4bbad9b4997a" />

**⭐ 如果牛马对你有帮助，请给个 Star 鼓励一下吧！**
