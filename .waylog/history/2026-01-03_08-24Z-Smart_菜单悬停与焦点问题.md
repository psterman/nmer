# Smart 菜单悬停与焦点问题
_Exported on 01/03/2026 at 16:27:40 GMT+8 from Cursor via WayLog_


**User**

CAPSLOCK+T截图后，激活的smart菜单只有第一个按钮有光效，其他按钮不能鼠标悬浮激活悬停效果，而且上下无法切换选择焦点

---


**Cursor**

检查 CAPSLOCK+T 截图后 smart 菜单的悬停和焦点切换问题。先查找相关代码。



查看 `ExecuteScreenshotWithMenu` 函数和键盘事件处理代码：



读取相关代码段以确认问题：

---


**User**

现在的smart菜单是不是图片？不是控件按钮，为什么无法选中和实现悬停效果

---


**Cursor**

检查 smart 菜单的创建方式，确认按钮是否为图片或 Text 控件：



确认按钮是用 `Text` 控件创建的，不是真正的 `Button`。检查悬停检测的实现，并查看是否有其他可用的悬停方法：



确认问题：`Text` 控件不支持原生的 `MouseEnter`/`MouseLeave`，当前使用定时器检测鼠标位置。改用 `WM_MOUSEMOVE` 消息处理悬停，并确保按钮能正确响应。检查并修复：

---


**User**

Error: Function calls require a space or "(".  Use comma only between parameters.

Text:	WinGet, MenuHwnd, ID, ahk_id %GuiID_ClipboardSmartMenu%
Line:	13315
File:	C:\Users\pster\Desktop\小c\CursorHelper (1).ahk

---


**Cursor**

修复语法错误：将 v1 语法改为 v2 语法。



已修复语法错误。问题在于使用了 AutoHotkey v1 的 `WinGet` 语法。在 v2 中应直接使用 `GuiID_ClipboardSmartMenu.Hwnd` 获取窗口句柄。

## 修复内容

将：
```ahk
WinGet, MenuHwnd, ID, ahk_id %GuiID_ClipboardSmartMenu%
MouseGetPos, , , , MouseWinHwnd, 2
```

改为：
```ahk
MenuHwnd := GuiID_ClipboardSmartMenu.Hwnd
MouseGetPos(, , , &MouseWinHwnd, 2)
```

现在代码应该可以正常运行了。请重新测试一下。

---


**User**

角色设定： 你是一名精通 AutoHotkey v2 的专家，擅长使用 GDI+ (Gdip) 和 WinClip 处理多媒体剪贴板数据。

任务背景： 我现在希望通过 lib/Gdip_All.ahk 和 lib/WinClip.ahk 库，大幅增强 CapsLock + t 截图后的处理逻辑，

核心逻辑需求：

拦截并增强截图逻辑：

修改 CapsLock + t 触发的截图函数。在截图完成后，不只是存入数据库，而是在智能菜单上方弹出一个**“截图助手预览窗”**。

利用 WinClip.GetBitmap() 获取截图数据，并通过 Gdip 在内存中缓存该位图。

UI 交互设计（预览窗）：

中央区域： 显示当前截图的缩略预览图。

下方工具栏： 一排图标按钮或文字按钮，包含：

[画笔]：简单的矩形红框标注。

[模糊]：对选中区域进行马赛克处理（利用 Gdip_BlurBitmap）。

[OCR]：调用项目中现有的 OCR.ahk 识别图中文字。

[复制]：处理后的图片通过 WinClip.SetBitmap() 重新放回剪贴板并关闭窗口。

[保存]：弹出文件保存对话框，将图片另存为本地文件。

[销毁]：放弃操作，关闭窗口并释放 Gdip 句柄。

数据结构结合：

所有的处理结果（原图或编辑后的图）都应自动保存到 A_ScriptDir "\Cache\"。

在 SQLite 数据库的 ClipboardHistory 表中同步插入一条记录，DataType 记为 "Image"，Content 记为本地缓存路径。

技术要求：

语法：必须严格遵守 AHK v2 语法。

内存管理：必须包含 Gdip_DisposeImage 和句柄释放逻辑，防止长时间运行内存溢出。

兼容性：考虑高 DPI 缩放，确保 GUI 中的图片显示不模糊。

---


**Cursor**

检查现有代码结构，准备实现截图助手预览窗。

---


**User**

Error: Missing comma

Text:	CreateRectF(ByRef RectF, x, y, w, h)
Line:	396
File:	C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk

---


**Cursor**

检查并修复 `Gdip_All.ahk` 中的语法错误。在 AutoHotkey v2 中，`ByRef` 的语法已更改。

---


**User**

Error: Missing comma

Text:	CreateRect(ByRef Rect, x, y, w, h)
Line:	415
File:	C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk

---


**Cursor**

检查第415行，确认是否已正确修复：



之前的修复未生效。重新修复 `CreateRect` 函数：



检查文件内容，确认是否有其他问题：



已确认 `CreateRect` 已修复。检查是否还有其他问题，并更新注释中的旧语法：

---


**User**

Error: Unknown class.

Text:	WinClip_base
Line:	9
File:	C:\Users\pster\Desktop\小c\lib\WinClip.ahk

---


**Cursor**

检查 `WinClip.ahk` 的依赖关系：



`WinClip.ahk` 依赖于 `WinClip_base`，该类定义在 `WinClipAPI.ahk` 中。需要在包含 `WinClip.ahk` 之前先包含 `WinClipAPI.ahk`。修复包含顺序：

---


**User**

Warning: This local variable appears to never be assigned a value.

Specifically: VarSetCapacity

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	083: Ptr := A_PtrSize ? "UPtr" : "UInt"
	085: If ((x != "") && (y != ""))
▶	086: VarSetCapacity(pt, 8), NumPut(x, pt, 0, "UInt"), NumPut(y, pt, 4, "UInt")

---


**Cursor**

修复 `VarSetCapacity` 的警告：在 AutoHotkey v2 中应使用 `Buffer()` 替代 `VarSetCapacity`。



已修复第86行的 `VarSetCapacity` 警告。在 AutoHotkey v2 中，应使用 `Buffer()` 替代 `VarSetCapacity`。

## 修复内容

将：
```ahk
VarSetCapacity(pt, 8), NumPut(x, pt, 0, "UInt"), NumPut(y, pt, 4, "UInt")
```

改为：
```ahk
pt := Buffer(8)
NumPut("UInt", x, pt, 0), NumPut("UInt", y, pt, 4)
```

文件中还有多处 `VarSetCapacity`（约42处）。这些警告不影响运行，但建议逐步替换为 `Buffer()`。当前修复的是警告中提到的第86行。

代码应可正常编译运行。如需，我可以继续修复其他 `VarSetCapacity` 的使用。

---


**User**

Warning: This local variable appears to never be assigned a value.

Specifically: w

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	240: }
	293: {
▶	294: WinGetRect(hwnd,,, w, h)

---


**Cursor**

检查并修复 `WinGetRect` 的调用问题：

---


**User**

Warning: This local variable appears to never be assigned a value.

Specifically: Width

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	362: }
	376: {
▶	377: WinGetRect(hwnd,,, Width, Height)Warning: This local variable appears to never be assigned a value.

Specifically: VarSetCapacity

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	471: Ptr := A_PtrSize ? "UPtr" : "UInt"
	473: hdc2 := hdc ? hdc : GetDC()
▶	474: VarSetCapacity(bi, 40, 0)Warning: This local variable appears to never be assigned a value.

Specifically: VarSetCapacity

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	545: Ptr := A_PtrSize ? "UPtr" : "UInt"
	546: Width := Height := 0
▶	548: VarSetCapacity(ICONINFO, size := 16 + 2 * A_PtrSize, 0)Warning: This local variable appears to never be assigned a value.

Specifically: FileInfo

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	783: RX1 := A_AhkVersion < "2" ? "mi
O)^" : "mi
)^"
	784: Offset := Size := 0
▶	785: If RegExMatch(TOC, RX1 . (Alternate ? File "\|.+?" : "\d+\|" . File) . "\|(\d+)\|(\d+)$", FileInfo)
	Warning: This local variable appears to never be assigned a value.

Specifically: VarSetCapacity

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	820: If !(DllCall("crypt32\CryptStringToBinary", Ptr, &Base64, "UInt", 0, "UInt", 0x01, Ptr, 0, "UIntP", DecLen, Ptr, 0, Ptr, 0))
	821: Return -1
▶	823: VarSetCapacity(Dec, DecLen, 0)Warning: This local variable appears to never be assigned a value.

Specifically: VarSetCapacity

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	1056: Points := StrSplit(Points, "|")
	1057: PointsLength := (A_AhkVersion < "2") ? Points.Length() : Points.Length
▶	1058: VarSetCapacity(PointF, 8*PointsLength)Warning: This local variable appears to never be assigned a value.

Specifically: VarSetCapacity

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	1148: Points := StrSplit(Points, "|")
	1149: PointsLength := (A_AhkVersion < "2") ? Points.Length() : Points.Length
▶	1150: VarSetCapacity(PointF, 8*PointsLength)Warning: This local variable appears to never be assigned a value.

Specifically: VarSetCapacity

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	1274: Points := StrSplit(Points, "|")
	1275: PointsLength := (A_AhkVersion < "2") ? Points.Length() : Points.Length
▶	1276: VarSetCapacity(PointF, 8*PointsLength)Warning: This local variable appears to never be assigned a value.

Specifically: VarSetCapacity

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	1411: Ptr := A_PtrSize ? "UPtr" : "UInt"
	1412: ImageAttr := 0
▶	1413: VarSetCapacity(ColourMatrix, 100, 0)Warning: This local variable appears to never be assigned a value.

Specifically: VarSetCapacity

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	1580: Extension := "." Extension
	1582: DllCall("gdiplus\GdipGetImageEncodersSize", "uint*", nCount, "uint*", nSize)
▶	1583: VarSetCapacity(ci, nSize)Warning: This local variable appears to never be assigned a value.

Specifically: A_IsUnicode

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	1585: If !(nCount && nSize)
	1586: Return -2
▶	1588: If (A_IsUnicode)Error: Too few parameters passed to function.

Specifically: NumPut

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	1634: {
	1635: _p := elem+&EncoderParameters-pad-4
▶	1636: NumPut(Quality, NumGet(NumPut(4, NumPut(1, _p+0)+20, "UInt")), "UInt")

---


**Cursor**

修复这些警告和错误：

---


**User**

Warning: This local variable appears to never be assigned a value.

Specifically: VarSetCapacity

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	552: hbmMask := NumGet(&ICONINFO, 16, Ptr)
	553: hbmColor := NumGet(&ICONINFO, 16 + A_PtrSize, Ptr)
▶	554: VarSetCapacity(BITMAP, size, 0)Warning: This local variable appears to never be assigned a value.

Specifically: Extension

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	1827: hIcon := 0
	1828: Ptr := A_PtrSize ? "UPtr" : "UInt" , PtrA := A_PtrSize ? "UPtr*" : "UInt*"
▶	1831: SplitPath(sFile,,, Extension)Warning: This local variable appears to never be assigned a value.

Specifically: VarSetCapacity

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	1834: Sizes := IconSize ? IconSize : 256 "|" 128 "|" 64 "|" 48 "|" 32 "|" 16
	1835: BufSize := 16 + (2*(A_PtrSize ? A_PtrSize : 4))
▶	1837: VarSetCapacity(buf, BufSize, 0)Warning: This local variable appears to never be assigned a value.

Specifically: VarSetCapacity

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	1915: }
	1919: {
▶	1921: DllCall("GetObject" ,    "ptr", hBitmap ,    "int", VarSetCapacity(dib, 76+2*(A_PtrSize=8?4:0)+2*A_PtrSize) ,    "ptr", &dib) , width  := NumGet(dib, 4, "uint") , height := NumGet(dib, 8, "uint") , bpp    := NumGet(dib, 18, "ushort")
	Warning: This local variable appears to never be assigned a value.

Specifically: VarSetCapacity

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	2000: DllCall("gdiplus\GdipGetImageHeight", "ptr", pBitmap, "uint*", height:=0)
	2004: hdc := DllCall("CreateCompatibleDC", "ptr", 0, "ptr")
▶	2005: VarSetCapacity(bi, 40, 0) , NumPut(      40, bi,  0,   "uint") , NumPut(   width, bi,  4,   "uint") , NumPut( -height, bi,  8,    "int") , NumPut(       1, bi, 12, "ushort") , NumPut(      32, bi, 14, "ushort")
	Warning: This local variable appears to never be assigned a value.

Specifically: VarSetCapacity

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	2095: off1 := A_PtrSize = 8 ? 52 : 44, off2 := A_PtrSize = 8 ? 32 : 24
	2096: hBitmap := Gdip_CreateHBITMAPFromBitmap(pBitmap)
▶	2097: DllCall("GetObject", Ptr, hBitmap, "int", VarSetCapacity(oi, A_PtrSize = 8 ? 104 : 84, 0), Ptr, &oi)
	Warning: This local variable appears to never be assigned a value.

Specifically: vPos

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	2353: RegExMatch(Options, pattern_opts "H([\-\d\.]+)(p*)", Height)
	2354: RegExMatch(Options, pattern_opts "C(?!(entre|enter))([a-f\d]+)", Colour)
▶	2355: RegExMatch(Options, pattern_opts "Top|Up|Bottom|Down|vCentre|vCenter", vPos)
	Warning: This local variable appears to never be assigned a value.

Specifically: NoWrap

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	2354: RegExMatch(Options, pattern_opts "C(?!(entre|enter))([a-f\d]+)", Colour)
	2355: RegExMatch(Options, pattern_opts "Top|Up|Bottom|Down|vCentre|vCenter", vPos)
▶	2356: RegExMatch(Options, pattern_opts "NoWrap", NoWrap)
Warning: This local variable appears to never be assigned a value.

Specifically: RC

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	2394: If !(hFamily && hFont && hFormat && pBrush && pGraphics)
	2395: Return !pGraphics ? -2 : !hFamily ? -3 : !hFont ? -4 : !hFormat ? -5 : !pBrush ? -6 : 0
▶	2397: CreateRectF(RC, xpos, ypos, Width, Height)
Warning: This local variable appears to never be assigned a value.

Specifically: VarSetCapacity

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	2648: If !DllCall("GetModuleHandle", "str", "gdiplus", Ptr)
	2649: DllCall("LoadLibrary", "str", "gdiplus")
▶	2650: VarSetCapacity(si, A_PtrSize = 8 ? 24 : 16, 0), si := Chr(1)
	Warning: This local variable appears to never be assigned a value.

Specifically: VarSetCapacity

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	2787: Ptr := A_PtrSize ? "UPtr" : "UInt"
	2789: CreateRect(_Rect, x, y, w, h)
▶	2790: VarSetCapacity(BitmapData, 16+2*(A_PtrSize ? A_PtrSize : 4), 0)Warning: This local variable appears to never be assigned a value.

Specifically: VarSetCapacity

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	2856: Else
	2857: MCode_PixelateBitmap := "4489442418488954241048894C24085355565741544155415641574883EC28418BC1448B8C24980000004C8BDA99488BD941F7F9448BD0448BFA8954240C448994248800000085C00F8E9D020000418BC04533E4458BF299448924244C8954241041F7F933C9898C24980000008BEA89542404448BE889442408EB054C8B5C24784585ED0F8E1A010000458BF1418BFD48897C2418450FAFF14533D233F633ED4533E44533ED4585C97E5B4C63BC2490000000418D040A410FAFC148984C8D441802498BD9498BD04D8BD90FB642010FB64AFF4403E80FB60203E90FB64AFE4883C2044403E003F149FFCB75DE4D03C748FFCB75D0488B7C24188B8C24980000004C8B5C2478418BC59941F7FE448BE8418BC49941F7FE448BE08BC59941F7FE8BE88BC69941F7FE8BF04585C97E4048639C24900000004103CA4D8BC1410FAFC94863C94A8D541902488BCA498BC144886901448821408869FF408871FE4883C10448FFC875E84803D349FFC875DA8B8C2498000000488B5C24704C8B5C24784183C20448FFCF48897C24180F850AFFFFFF8B6C2404448B2424448B6C24084C8B74241085ED0F840A01000033FF33DB4533DB4533D24533C04585C97E53488B74247085ED7E42438D0C04418BC50FAF8C2490000000410FAFC18D04814863C8488D5431028BCD0FB642014403D00F
▶	2884: VarSetCapacity(PixelateBitmap, StrLen(MCode_PixelateBitmap)//2)

	Warning: This local variable appears to never be assigned a value.

Specifically: Width

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	2889: DllCall("VirtualProtect", Ptr, &PixelateBitmap, Ptr, VarSetCapacity(PixelateBitmap), "uint", 0x40, A_PtrSize ? "UPtr*" : "UInt*", 0)
	2890: }
▶	2892: Gdip_GetImageDimensions(pBitmap, Width, Height)Warning: This local variable appears to never be assigned a value.

Specifically: Height

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	2889: DllCall("VirtualProtect", Ptr, &PixelateBitmap, Ptr, VarSetCapacity(PixelateBitmap), "uint", 0x40, A_PtrSize ? "UPtr*" : "UInt*", 0)
	2890: }
▶	2892: Gdip_GetImageDimensions(pBitmap, Width, Height)Warning: This local variable appears to never be assigned a value.

Specifically: Stride1

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	2896: If (BlockSize > Width || BlockSize > Height)
	2897: Return -2
▶	2899: E1 := Gdip_LockBits(pBitmap, 0, 0, Width, Height, Stride1, Scan01, BitmapData1)
	Warning: This local variable appears to never be assigned a value.

Specifically: Stride2

	---- C:\Users\pster\Desktop\小c\lib\Gdip_All.ahk
	2897: Return -2
	2899: E1 := Gdip_LockBits(pBitmap, 0, 0, Width, Height, Stride1, Scan01, BitmapData1)
▶	2900: E2 := Gdip_LockBits(pBitmapOut, 0, 0, Width, Height, Stride2, Scan02, BitmapData2)

---


**Cursor**

修复剩余的警告和错误：

---


**User**

继续

---


**Cursor**

继续修复剩余的警告：

---


**User**

Warning: This local variable appears to never be assigned a value.

Specifically: clip

	26893: Sleep(200)
	26894: }
▶	26897: hBitmap := clip.GetBitmap()

---


**Cursor**

检查 `clip` 变量的使用情况：



在 `ExecuteScreenshotOCR()` 中，`clip` 未初始化就被使用。添加初始化：

---


**User**

重构这段代码，遵循PEP8/行业规范，简化冗余逻辑，添加中文注释，保持功能不变

---


**User**

截图助手失败

---


**Cursor**

检查 `ShowScreenshotEditor()` 函数，定位导致“Expected a Number but got a VarRef”错误的原因：

---


**User**

capslock+t后没有弹出截图助手菜单

---


**Cursor**

检查 CapsLock+T 的触发逻辑和截图助手菜单的显示：

---


**User**

替换了一个新的Gdip_All.ahk,截图显示错误，无法加载截图助手菜单

---


**Cursor**

检查 `ShowScreenshotEditor()` 中使用的 Gdip 函数，确认与新 `Gdip_All.ahk` 的兼容性：



检查新的 `Gdip_All.ahk` 中这些函数的实现，确认函数签名和调用方式：



修复异常处理和函数调用问题：

---


**User**

给我一个弹窗提示，推导这个错误的来源和出处是什么

---


**Cursor**

添加一个详细的错误诊断弹窗，帮助定位错误来源：

---


**User**

Error: Missing "propertyname:" in object literal.

	27080: CopyBtn := ErrorGui.Add("Button", "x480 y520 w120 h35", "复制信息")
	27081: {
▶	27081: Return  { A_Clipboard := ErrorInfo TrayTip("提示", "错误信息已复制到剪贴板", "Iconi 1") }

---


**Cursor**

修复箭头函数语法错误：



已修复箭头函数语法错误。在 AHK v2 中，箭头函数的多行代码块应使用括号 `()` 而不是大括号 `{}`，因为大括号会被解释为对象字面量。

修复后的代码使用逗号分隔的表达式列表，这是 AHK v2 中箭头函数多行代码的正确写法。

请重新测试，错误诊断窗口应能正常显示。

---


**User**

【错误诊断报告】

═══════════════════════════════════════
错误消息: An exception was thrown.
错误文件: C:\Users\pster\Desktop\小c\lib\WinClipAPI.ahk
错误行号: 45
═══════════════════════════════════════

【关键变量状态】
───────────────────────────────────────
ScreenshotClipboard: 已设置 (长度: 对象)
GuiID_ScreenshotEditor: 0 (未创建)
ScreenshotEditorBitmap: 0 (未创建)
ScreenshotEditorGraphics: 0 (未创建)
───────────────────────────────────────

【可能的原因分析】
───────────────────────────────────────
⚠️ 未识别的错误类型
   - 错误消息: An exception was thrown.
   - 建议: 查看错误行号和文件定位问题

───────────────────────────────────────

【调试建议】
───────────────────────────────────────
1. 检查错误发生的具体行号: 45
2. 检查错误文件: C:\Users\pster\Desktop\小c\lib\WinClipAPI.ahk
3. 确认截图是否成功完成
4. 检查系统剪贴板是否包含图片数据
5. 尝试重新运行脚本
───────────────────────────────────────

---


**Cursor**

检查 `WinClipAPI.ahk` 第 45 行，定位错误原因：



错误发生在 `WinClipAPI.ahk` 第 45 行的 `memcopy` 函数。检查调用处并添加参数验证：

---


**User**

Error: Missing "propertyname:" in object literal.

	27080: CopyBtn := ErrorGui.Add("Button", "x480 y520 w120 h35", "复制信息")
	27081: {
▶	27081: Return  { A_Clipboard := ErrorInfo TrayTip("提示", "错误信息已复制到剪贴板", "Iconi 1") }

---


**Cursor**

检查并修复箭头函数语法错误：



改用函数引用方式，避免箭头函数语法问题：

---


**User**

请修复这个问题

---


**Cursor**

检查并修复 `memcopy` 失败问题。先查看相关代码：

---


**User**

capslock+t截图后，助手菜单还是没有弹出，给我一个进程弹窗显示步骤问题出在哪里

---


**Cursor**

添加调试弹窗，显示截图流程的每一步，定位问题：

---


**User**

Error: Missing ending "%"

Text:	% 10 = 0)
Line:	22725

---


**Cursor**

检查并修复语法错误：



已修复语法错误。在 AHK v2 中，取模运算符 `%` 已改为使用 `Mod()` 函数。

## 修复内容

- 第 22725 行：将 `CheckCount % 10` 改为 `Mod(CheckCount, 10)`

这是 AHK v2 的语法变更。请重新测试，错误应已解决。

---
